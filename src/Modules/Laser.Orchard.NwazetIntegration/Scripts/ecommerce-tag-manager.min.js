window.ecommerceData=$.extend(!0,{},window.ecommerceData);window.ecommerceData.detail=$.extend(!0,{},window.ecommerceData.detail);window.ecommerceData.detail.products=window.ecommerceData.detail.products||[];window.ecommerceData.impressions=window.ecommerceData.impressions||[];window.ecommerceData.cart=$.extend(!0,{},window.ecommerceData.cart);window.ecommerceData.cart.products=window.ecommerceData.cart.products||[];window.ecommerceData.purchase=$.extend(!0,{},window.ecommerceData.purchase);window.ecommerceData.purchase.actionField=$.extend(!0,{},window.ecommerceData.purchase.actionField);window.ecommerceData.purchase.products=window.ecommerceData.purchase.products||[];window.ecommerceData.checkout=$.extend(!0,{},window.ecommerceData.checkout);window.ecommerceData.checkout.actionField=$.extend(!0,{},window.ecommerceData.checkout.actionField);window.ecommerceData.checkout.products=window.ecommerceData.checkout.products||[];$(function(){var n,t,r;window.ecommerceData=$.extend(!0,{},window.ecommerceData);window.ecommerceData.detail=$.extend(!0,{},window.ecommerceData.detail);window.ecommerceData.detail.products=window.ecommerceData.detail.products||[];window.ecommerceData.impressions=window.ecommerceData.impressions||[];window.ecommerceData.cart=$.extend(!0,{},window.ecommerceData.cart);window.ecommerceData.cart.products=window.ecommerceData.cart.products||[];window.ecommerceData.purchase=$.extend(!0,{},window.ecommerceData.purchase);window.ecommerceData.purchase.actionField=$.extend(!0,{},window.ecommerceData.purchase.actionField);window.ecommerceData.purchase.products=window.ecommerceData.purchase.products||[];window.ecommerceData.checkout=$.extend(!0,{},window.ecommerceData.checkout);window.ecommerceData.checkout.actionField=$.extend(!0,{},window.ecommerceData.checkout.actionField);window.ecommerceData.checkout.products=window.ecommerceData.checkout.products||[];n={};window.ecommerceData.impressions.length&&(n.impressions=window.ecommerceData.impressions);window.ecommerceData.detail.products.length&&(n.detail=window.ecommerceData.detail);$.isEmptyObject(window.ecommerceData.purchase)||$.isEmptyObject(window.ecommerceData.purchase.actionField)||(n.purchase=window.ecommerceData.purchase);$.isEmptyObject(window.ecommerceData.checkout)||$.isEmptyObject(window.ecommerceData.checkout.actionField)||(n.checkout=window.ecommerceData.checkout);window.dataLayer=window.dataLayer||[];$.isEmptyObject(n)||window.dataLayer.push({ecommerce:n});t=function(n,t){var u={},r;for(i=0;i<n.length;i++)if(r=n[i],r.partId==t){u=r;break}return u};r=function(n){var u=$(n).find(".quantity"),e,o,c,s,f,h,r;if(u&&u.length){for(e=[],o=[],i=0;i<u.length;i++)if(c=$(u[i]).attr("data-cart-product-id"),s=$(u[i]).val(),c&&s){if(f=t(window.ecommerceData.cart.products,c),$.isEmptyObject(f))break;s!=f.quantity&&(h=s-f.quantity,r={},r=Object.assign(r,f),h>0?(r.quantity=h,e.push(r)):(r.quantity=-h,o.push(r)))}e.length&&window.dataLayer.push({event:"addToCart",ecommerce:{add:{products:e}}});o.length&&window.dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:o}}})}};$(document).on("nwazet.addedtocart","form.addtocart",function(){var i=$(this).serializeArray().reduce(function(n,t){return n[t.name]=t.value,n},{}),r=i.id,n=t(window.ecommerceData.detail.products,r),u;($.isEmptyObject(n)&&(n=t(window.ecommerceData.impressions,r)),$.isEmptyObject(n))||(u=i.quantity,n.quantity=u,window.dataLayer.push({event:"addToCart",ecommerce:{add:{products:[n]}}}))}).on("nwazet.removefromcart",".shoppingcart .delete",function(){var i=$(this).attr("data-cart-product-id"),n=t(window.ecommerceData.cart.products,i);$.isEmptyObject(n)||(n.quantity>0&&(window.dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:[n]}}}),n.quantity=0),console.log("removefromcart"))}).on("change",".shoppingcart .quantity",function(){var r=$(this).attr("data-cart-product-id"),i=t(window.ecommerceData.cart.products,r),n;$.isEmptyObject(i)||(n=$(this).val(),i.currentQuantity=n,console.log("quantity changed to "+n))}).on("submit",".shopping-cart-container form",function(n){r(n.target)}).on("submit",".shoppingcart form",function(n){r(n.target)}).on("submit","form .shopping-cart-container",function(n){r(n.target)}).on("submit","form .shoppingcart",function(n){r(n.target)}).on("click","[data-product-id]",function(){var i=$(this).attr("data-product-id"),n=t(window.ecommerceData.impressions,i);$.isEmptyObject(n)||window.dataLayer.push({event:"productClick",ecommerce:{click:{products:[n]}}})})});