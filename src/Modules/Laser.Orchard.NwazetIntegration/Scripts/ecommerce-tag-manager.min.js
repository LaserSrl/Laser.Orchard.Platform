window.ecommerceData=$.extend(!0,{},window.ecommerceData);window.ecommerceData.detail=$.extend(!0,{},window.ecommerceData.detail);window.ecommerceData.detail.products=window.ecommerceData.detail.products||[];window.ecommerceData.impressions=window.ecommerceData.impressions||[];window.ecommerceData.cart=$.extend(!0,{},window.ecommerceData.cart);window.ecommerceData.cart.products=window.ecommerceData.cart.products||[];window.ecommerceData.purchase=$.extend(!0,{},window.ecommerceData.purchase);window.ecommerceData.purchase.actionField=$.extend(!0,{},window.ecommerceData.purchase.actionField);window.ecommerceData.purchase.products=window.ecommerceData.purchase.products||[];window.ecommerceData.checkout=$.extend(!0,{},window.ecommerceData.checkout);window.ecommerceData.checkout.actionField=$.extend(!0,{},window.ecommerceData.checkout.actionField);window.ecommerceData.checkout.products=window.ecommerceData.checkout.products||[];window.GA4Data=$.extend(!0,{},window.GA4Data);window.GA4Data.event=window.GA4Data.event||"";window.GA4Data.ecommerce=$.extend(!0,{},window.GA4Data.ecommerce);window.GA4Data.ecommerce.items=window.GA4Data.ecommerce.items||[];window.GA4Data.ecommerce.transaction_id=window.GA4Data.ecommerce.transaction_id||"";window.GA4Data.ecommerce.affiliation=window.GA4Data.ecommerce.affiliation||"";window.GA4Data.ecommerce.value=window.GA4Data.ecommerce.value||"";window.GA4Data.ecommerce.tax=window.GA4Data.ecommerce.tax||"";window.GA4Data.ecommerce.shipping=window.GA4Data.ecommerce.shipping||"";window.GA4Data.ecommerce.currency=window.GA4Data.ecommerce.currency||"";window.GA4Data.ecommerce.coupon=window.GA4Data.ecommerce.coupon||"";$(function(){var t,n,i,r;window.ecommerceData=$.extend(!0,{},window.ecommerceData);window.ecommerceData.detail=$.extend(!0,{},window.ecommerceData.detail);window.ecommerceData.detail.products=window.ecommerceData.detail.products||[];window.ecommerceData.impressions=window.ecommerceData.impressions||[];window.ecommerceData.cart=$.extend(!0,{},window.ecommerceData.cart);window.ecommerceData.cart.products=window.ecommerceData.cart.products||[];window.ecommerceData.purchase=$.extend(!0,{},window.ecommerceData.purchase);window.ecommerceData.purchase.actionField=$.extend(!0,{},window.ecommerceData.purchase.actionField);window.ecommerceData.purchase.products=window.ecommerceData.purchase.products||[];window.ecommerceData.checkout=$.extend(!0,{},window.ecommerceData.checkout);window.ecommerceData.checkout.actionField=$.extend(!0,{},window.ecommerceData.checkout.actionField);window.ecommerceData.checkout.products=window.ecommerceData.checkout.products||[];window.GA4Data=$.extend(!0,{},window.GA4Data);window.GA4Data.event=window.GA4Data.event||"";window.GA4Data.ecommerce=$.extend(!0,{},window.GA4Data.ecommerce);window.GA4Data.ecommerce.items=window.GA4Data.ecommerce.items||[];window.GA4Data.ecommerce.transaction_id=window.GA4Data.ecommerce.transaction_id||"";window.GA4Data.ecommerce.affiliation=window.GA4Data.ecommerce.affiliation||"";window.GA4Data.ecommerce.value=window.GA4Data.ecommerce.value||"";window.GA4Data.ecommerce.tax=window.GA4Data.ecommerce.tax||"";window.GA4Data.ecommerce.shipping=window.GA4Data.ecommerce.shipping||"";window.GA4Data.ecommerce.currency=window.GA4Data.ecommerce.currency||"";window.GA4Data.ecommerce.coupon=window.GA4Data.ecommerce.coupon||"";t={};window.ecommerceData.impressions.length&&(t.impressions=window.ecommerceData.impressions);window.ecommerceData.detail.products.length&&(t.detail=window.ecommerceData.detail);$.isEmptyObject(window.ecommerceData.purchase)||$.isEmptyObject(window.ecommerceData.purchase.actionField)||(t.purchase=window.ecommerceData.purchase);$.isEmptyObject(window.ecommerceData.checkout)||$.isEmptyObject(window.ecommerceData.checkout.actionField)||(t.checkout=window.ecommerceData.checkout);n={};$.isEmptyObject(window.GA4Data)||window.GA4Data.event==""||$.isEmptyObject(window.GA4Data.ecommerce)||!window.GA4Data.ecommerce.items.length||(n.event=window.GA4Data.event,n.ecommerce=window.GA4Data.ecommerce,n.event=="purchase"&&(n.ecommerce.transaction_id=window.GA4Data.ecommerce.transaction_id||"",n.ecommerce.affiliation=window.GA4Data.ecommerce.affiliation||"",n.ecommerce.value=window.GA4Data.ecommerce.value||"",n.ecommerce.tax=window.GA4Data.ecommerce.tax||"",n.ecommerce.shipping=window.GA4Data.ecommerce.shipping||"",n.ecommerce.currency=window.GA4Data.ecommerce.currency||"",n.ecommerce.coupon=window.GA4Data.ecommerce.coupon||""));window.dataLayer=window.dataLayer||[];$.isEmptyObject(t)||window.dataLayer.push({ecommerce:t});$.isEmptyObject(n)||window.dataLayer.push(n);i=function(n,t){for(var r,u={},i=0;i<n.length;i++)if(r=n[i],r.partId==t){u=r;break}return u};r=function(n){var r=$(n).find(".quantity"),u,f,e,c,s,o,h,t;if(r&&r.length){for(u=[],f=[],e=0;e<r.length;e++)if(c=$(r[e]).attr("data-cart-product-id"),s=$(r[e]).val(),c&&s){if(o=i(window.ecommerceData.cart.products,c),$.isEmptyObject(o))break;s!=o.quantity&&(h=s-o.quantity,t={},t=Object.assign(t,o),h>0?(t.quantity=h,u.push(t)):(t.quantity=-h,f.push(t)))}u.length&&(window.useGA4?window.dataLayer.push({event:"add_to_cart",ecommerce:{items:u}}):window.dataLayer.push({event:"addToCart",ecommerce:{add:{products:u}}}));f.length&&(window.useGA4?window.dataLayer.push({event:"remove_from_cart",ecommerce:{items:f}}):window.dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:f}}}))}};$(document).on("nwazet.addedtocart","form.addtocart",function(n,t){var e=$(this).serializeArray().reduce(function(n,t){return n[t.name]=t.value,n},{}),u=e.id,r=i(window.ecommerceData.detail.products,u),f;($.isEmptyObject(r)&&(r=i(window.ecommerceData.impressions,u)),$.isEmptyObject(r))||(f=t.movedQuantity,r.quantity=f,window.useGA4?window.dataLayer.push({event:"add_to_cart",ecommerce:{items:[r]}}):window.dataLayer.push({event:"addToCart",ecommerce:{add:{products:[r]}}}))}).on("nwazet.removefromcart","form.addtocart",function(){var t=$(this).attr("data-cart-product-id"),n=i(window.ecommerceData.cart.products,t);$.isEmptyObject(n)||(n.quantity>0&&(window.useGA4?window.dataLayer.push({event:"remove_from_cart",ecommerce:{items:[n]}}):window.dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:[n]}}}),n.quantity=0),console.log("removefromcart"))}).on("change",".shoppingcart .quantity",function(){var r=$(this).attr("data-cart-product-id"),t=i(window.ecommerceData.cart.products,r),n;$.isEmptyObject(t)||(n=$(this).val(),t.currentQuantity=n,console.log("quantity changed to "+n))}).on("submit",".shopping-cart-container form",function(n){r(n.target)}).on("submit","form .shopping-cart-container",function(n){r(n.target)}).on("submit","form .shoppingcart",function(n){r(n.target)}).on("submit",".shoppingcart form",function(n){r(n.target)}).on("click","[data-product-id]",function(){var t=$(this).attr("data-product-id"),n=i(window.ecommerceData.impressions,t);$.isEmptyObject(n)||(window.useGA4?window.dataLayer.push({event:"select_item",ecommerce:{items:[n]}}):window.dataLayer.push({event:"productClick",ecommerce:{click:{products:[n]}}}))})});