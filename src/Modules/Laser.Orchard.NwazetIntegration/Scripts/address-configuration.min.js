function buildAddressUI(n){var t;global_CopyingAddresses=typeof global_CopyingAddresses=="undefined"?!1:global_CopyingAddresses;global_ChangingProgrammatically=typeof global_ChangingProgrammatically=="undefined"?!1:global_ChangingProgrammatically;global_PreventResetChoices=!1;var r=n.elementsPrefix.slice(0,-1),u={placeholder:$("#"+n.elementsPrefix+"CountryId").attr("placeholder")},f={placeholder:$("#"+n.elementsPrefix+"CitySelectedId").attr("placeholder"),ajax:{url:n.cities.getUrl,data:function(t){return{query:t.term,countryId:$("#"+n.elementsPrefix+"CountryId option").filter(":selected").val(),isBillingAddress:n.isBillingAddress}},processResults:function(n){return{results:$.map(n,function(n){return{id:n.Value,text:n.Label}})}}}},e={placeholder:$("#"+n.elementsPrefix+"ProvinceSelectedId").attr("placeholder"),ajax:{url:n.provinces.getUrl,data:function(t){return{query:t.term,countryId:$("#"+n.elementsPrefix+"CountryId option").filter(":selected").val(),cityId:$("#"+n.elementsPrefix+"CityId").val(),cityName:"",isBillingAddress:n.isBillingAddress}},processResults:function(n){return{results:$.map(n.Provinces,function(n){return{id:n.Value,text:n.Text}})}}}},o=$.extend(u,n.countries.select2Options),s=$.extend(f,n.cities.select2Options),h=$.extend(e,n.provinces.select2Options);$("#"+n.elementsPrefix+"CountryId").select2(o);$("#"+n.elementsPrefix+"CitySelectedId").select2(s);$("#"+n.elementsPrefix+"ProvinceSelectedId").select2(h);$("#"+n.elementsPrefix+"CitySelectedId").on("change",function(t){global_ChangingProgrammatically=!0;global_CopyingAddresses||(t.currentTarget.selectedOptions.length>0?($("#"+n.elementsPrefix+"CityId").val(t.currentTarget.selectedOptions[0].value),$("#"+n.elementsPrefix+"City").val(t.currentTarget.selectedOptions[0].text)):($("#"+n.elementsPrefix+"CityId").val(0),$("#"+n.elementsPrefix+"City").val("")),$("#"+n.elementsPrefix+"ProvinceId").val(0),$("#"+n.elementsPrefix+"Province").val(""),$("#"+n.elementsPrefix+"ProvinceSelectedId").empty());global_ChangingProgrammatically=!1});$("#"+n.elementsPrefix+"City").on("change",function(){global_CopyingAddresses||global_ChangingProgrammatically||$("#"+n.elementsPrefix+"CityId").val(0)});$("#"+n.elementsPrefix+"ProvinceSelectedId").on("change",function(t){global_ChangingProgrammatically=!0;global_CopyingAddresses||(t.currentTarget.selectedOptions.length>0?($("#"+n.elementsPrefix+"ProvinceId").val(t.currentTarget.selectedOptions[0].value),$("#"+n.elementsPrefix+"Province").val(t.currentTarget.selectedOptions[0].text)):($("#"+n.elementsPrefix+"ProvinceId").val(0),$("#"+n.elementsPrefix+"Province").val("")));global_ChangingProgrammatically=!1});$("#"+n.elementsPrefix+"Province").on("change",function(){global_CopyingAddresses||global_ChangingProgrammatically||$("#"+n.elementsPrefix+"ProvinceId").val(0)});$("#"+n.elementsPrefix+"CountryId").on("change",function(t){if(t.currentTarget.selectedOptions.length>0){var i={territoryId:t.currentTarget.selectedOptions[0].value},r=!global_CopyingAddresses&&!global_PreventResetChoices;$.ajax({url:n.countries.administrativeInfoUrl,data:i,success:function(t){var i=t.HasCities,u=t.HasProvinces;r&&($("#"+n.elementsPrefix+"CityId").val(0),$("#"+n.elementsPrefix+"CitySelectedId").empty(),$("#"+n.elementsPrefix+"City").val(""),$("#"+n.elementsPrefix+"ProvinceId").val(0),$("#"+n.elementsPrefix+"ProvinceSelectedId").empty(),$("#"+n.elementsPrefix+"Province").val(""));i?Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"CitySelectedId"),!0):Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"CitySelectedId"),!1);u?Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"ProvinceSelectedId"),!0):Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"ProvinceSelectedId"),!1)}})}});$("#"+r+"ListAddress").on("change",function(){if(arrayOfStoredAddresses=n.arrayOfStoredAddresses,$(this).val()==-1)$("#"+n.guid).find("input").val(""),global_CopyingAddresses=!0,$("#"+n.elementsPrefix+"Honorific").val("").trigger("change"),$("#"+n.elementsPrefix+"FirstName").val("").trigger("change"),$("#"+n.elementsPrefix+"LastName").val("").trigger("change"),$("#"+n.elementsPrefix+"Company").val("").trigger("change"),$("#"+n.elementsPrefix+"Address1").val("").trigger("change"),$("#"+n.elementsPrefix+"Address2").val("").trigger("change"),$("#"+n.elementsPrefix+"PostalCode").val("").trigger("change"),$("#"+n.elementsPrefix+"CityId").val(0).trigger("change"),$("#"+n.elementsPrefix+"ProvinceId").val(0).trigger("change"),$("#"+n.elementsPrefix+"CitySelectedId").empty().trigger("change"),$("#"+n.elementsPrefix+"ProvinceSelectedId").empty().trigger("change"),$("#"+n.elementsPrefix+"City").val("").trigger("change"),$("#"+n.elementsPrefix+"Province").val("").trigger("change"),global_CopyingAddresses=!1;else for(i=0;i<arrayOfStoredAddresses.length;i++)if(arrayOfStoredAddresses[i].Id==$(this).val()){$("#"+n.elementsPrefix+"Honorific").val(arrayOfStoredAddresses[i].Honorific).trigger("change");$("#"+n.elementsPrefix+"FirstName").val(arrayOfStoredAddresses[i].FirstName).trigger("change");$("#"+n.elementsPrefix+"LastName").val(arrayOfStoredAddresses[i].LastName).trigger("change");$("#"+n.elementsPrefix+"Company").val(arrayOfStoredAddresses[i].Company).trigger("change");$("#"+n.elementsPrefix+"Address1").val(arrayOfStoredAddresses[i].Address1).trigger("change");$("#"+n.elementsPrefix+"Address2").val(arrayOfStoredAddresses[i].Address2).trigger("change");$("#"+n.elementsPrefix+"PostalCode").val(arrayOfStoredAddresses[i].PostalCode).trigger("change");$("#"+n.elementsPrefix+"CityId").val(arrayOfStoredAddresses[i].CityId).trigger("change");$("#"+n.elementsPrefix+"ProvinceId").val(arrayOfStoredAddresses[i].ProvinceId).trigger("change");$("#"+n.elementsPrefix+"City").val(arrayOfStoredAddresses[i].City).trigger("change");$("#"+n.elementsPrefix+"Province").val(arrayOfStoredAddresses[i].Province).trigger("change");var t;$("#"+n.elementsPrefix+"CitySelectedId").find("option[value='"+arrayOfStoredAddresses[i].CityId+"']").length?$("#"+n.elementsPrefix+"CitySelectedId").val(arrayOfStoredAddresses[i].CityId).trigger("change"):(t=new Option(arrayOfStoredAddresses[i].City,arrayOfStoredAddresses[i].CityId,!0,!0),$("#"+n.elementsPrefix+"CitySelectedId").append(t).trigger("change"));$("#"+n.elementsPrefix+"ProvinceSelectedId").find("option[value='"+arrayOfStoredAddresses[i].ProvinceId+"']").length?$("#"+n.elementsPrefix+"ProvinceSelectedId").val(arrayOfStoredAddresses[i].ProvinceId).trigger("change"):(t=new Option(arrayOfStoredAddresses[i].Province,arrayOfStoredAddresses[i].ProvinceId,!0,!0),$("#"+n.elementsPrefix+"ProvinceSelectedId").append(t).trigger("change"));$("#"+n.elementsPrefix+"CountryId option[value="+arrayOfStoredAddresses[i].CountryId+"]").prop("selected",!0);global_CopyingAddresses=!0;$("#"+n.elementsPrefix+"CountryId").trigger("change");global_CopyingAddresses=!1}});parseInt($("#"+n.elementsPrefix+"CountryId").val())>0&&(global_PreventResetChoices=!0,$("#"+n.elementsPrefix+"CountryId").trigger("change"),global_PreventResetChoices=!1);n.basicAddress!=null&&($(n.basicAddress.selector).hide(),t=[{source:"Honorific",target:"Honorific"},{source:"FirstName",target:"FirstName"},{source:"LastName",target:"LastName"},{source:"Company",target:"Company"},{source:"PostalCode",target:"PostalCode"},{source:"Address1",target:"Address1"},{source:"Address2",target:"Address2"},{source:"City",target:"City"},{source:"Province",target:"Province"},{source:"CitySelectedId",target:"City"},{source:"ProvinceSelectedId",target:"Province"},{source:"CountryId",target:"Country"}],t.forEach(function(t){$("#"+n.elementsPrefix+t.source).on("change",function(){$(this).prop("tagName").toLowerCase()=="input"?$("#"+n.basicAddress.elementsPrefix+t.target).val($(this).val()):$(this).prop("tagName").toLowerCase()=="select"&&($("option:selected",this)!=null?$("#"+n.basicAddress.elementsPrefix+t.target).val($("option:selected",this).text()):$("#"+n.basicAddress.elementsPrefix+t.target).val(""))})}));EnsureVisibility(n)}function Select2ShippingAddressVisibility(n,t){var i=$("#"+n.attr("id").slice(0,-10));t?(i.hide(),n.next(".select2-container").show()):(n.next(".select2-container").hide(),i.show())}function EnsureVisibility(n){n.cities.selectedId>0?Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"CitySelectedId"),!0):Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"CitySelectedId"),!1);n.provinces.selectedId>0?Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"ProvinceSelectedId"),!0):Select2ShippingAddressVisibility($("#"+n.elementsPrefix+"ProvinceSelectedId"),!1)}