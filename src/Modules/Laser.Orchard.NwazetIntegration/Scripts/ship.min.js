function shippingAddressHasChanged(n){var f=$("#toggle-billing-address"),t,u,r,i;f.prop("checked")&&(t=n,u=t.attr("name").indexOf(".")>0?t.attr("name").substr(18):t.attr("name").substr(17),n.prop("tagName").toLowerCase()=="input"?$('input[name="billingAddressVM.'+u+'"]').val(t.val()).trigger("change"):n.prop("tagName").toLowerCase()=="select"&&(u!="ListAddress"?(r=$('select[name="billingAddressVM.'+u+'"]'),i=t.val(),r.find('option[value="'+i+'"]').length==0&&(newOption=new Option(t.find("option[value="+i+"]").text(),i,!0,!0),r.append(newOption))):(r=$('select[name="billingAddressVMListAddress"]'),i="-1"),r.val(i),(i!="-1"||u!="ListAddress")&&r.trigger("change")))}var global_CopyingAddresses=!1,global_ChangingProgrammatically=!1;$(function(){var n=$("#address-form"),i=$(".ship-errors"),t=$("#toggle-billing-address");t.change(function(){$(".billing-address").toggle($(this).val());global_CopyingAddresses=!0;($(this).val()==="on"||$(this).val()==="true")&&($('input[name^="shippingAddressVM."]').each(function(){shippingAddressHasChanged($(this))}),shippingAddressHasChanged($('select[name="shippingAddressVMListAddress"]')),$('select[name^="shippingAddressVM."]').each(function(){shippingAddressHasChanged($(this))}));$(".billing-address").trigger("visibilityChanged");global_CopyingAddresses=!1});t.prop("checked")&&$(".billing-address").hide();$('input[name^="shippingAddressVM."]').change(function(){shippingAddressHasChanged($(this))});$('select[name="shippingAddressVMListAddress"]').change(function(){shippingAddressHasChanged($(this))});$('select[name^="shippingAddressVM."]').change(function(){shippingAddressHasChanged($(this))});"preventRequiredMark"in window&&preventRequiredMark||n.find(".required").after($("<span class='error-indicator' title='"+required+"'>*<\/span>"));n.submit(function(r){var u=!0,f,e=[];return i.empty(),n.find(".required").each(function(){var r=$(this).data("requiredfield")?$("#"+$(this).data("requiredfield")):$(this),h=$(this).data("requiredlabelfor")?n.find("label[for='"+$(this).data("requiredlabelfor")+"']").html():n.find("label[for='"+$(this).attr("id")+"']").html(),o=$(this).data("requiredvisibleelement")?$("#"+$(this).data("requiredvisibleelement")):r,c=$(this).data("requiredpattern")?$(this).data("requiredpattern"):"",s,l;if((r.is("input")||r.is("select"))&&o.is(":visible")){if(s=!0,(t.val()==="on"||t.val()==="true")&&r.parents(".billing-address").length)return!0;if(c!=""||r.val()?(l=new RegExp(c),l.test(r.val())||(u=s=!1)):u=s=!1,s)o.removeClass("required-error");else if(o.addClass("required-error"),e.indexOf(h)===-1&&(i.show().append($("<div><\/div>").html(requiredFormat.replace("{0}",h))),e.push(h)),!f){f=o;var a=$(this).offset().top,v=$(this).height(),y=$(window).height(),p;p=v<y?a-(y/2-v/2):a;$("body,html").animate({scrollTop:p},800)}}}),u?void 0:(r.preventDefault(),!1)})});