{"version":3,"file":"accordion.js","sources":["../../src/js/plugins/accordion.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component.js'\r\n\r\nimport EventHandler from 'bootstrap/js/src/dom/event-handler'\r\nimport SelectorEngine from 'bootstrap/js/src/dom/selector-engine'\r\n\r\nimport { focusSimbling } from './util/dom'\r\n\r\nconst NAME = 'accordion'\r\nconst DATA_KEY = 'bs.accordion'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\n\r\nconst EVENT_KEYDOWN = `keydown${EVENT_KEY}`\r\nconst EVENT_KEYDOWN_DATA_API = `keydown${EVENT_KEY}${DATA_API_KEY}`\r\n\r\nconst SELECTOR_HEADBTN_WRAPPER = '.accordion'\r\nconst SELECTOR_HEADBTN = '.accordion-item > .accordion-header [data-bs-toggle=\"collapse\"]'\r\n\r\nclass Accordion extends BaseComponent {\r\n  constructor(element) {\r\n    super(element)\r\n\r\n    this._bindEvents()\r\n  }\r\n\r\n  // Getters\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n  handleKeyDown(keyName, target, evt) {\r\n    const eventKeyCallback = {\r\n      ArrowDown: (target) => this._focusNext(target),\r\n      ArrowUp: (target) => this._focusPrev(target),\r\n      Home: (target) => this._focusFirst(target),\r\n      End: (target) => this._focusLast(target),\r\n    }\r\n    if (typeof eventKeyCallback[keyName] === 'function') {\r\n      if (evt) {\r\n        evt.preventDefault()\r\n      }\r\n      eventKeyCallback[keyName](target)\r\n    }\r\n  }\r\n\r\n  // Private\r\n  _bindEvents() {\r\n    //fix collapse accessibility (arrow keys, home key, end key functionality)\r\n\r\n    SelectorEngine.find(SELECTOR_HEADBTN, this._element).forEach((accHead) => {\r\n      EventHandler.on(accHead, EVENT_KEYDOWN, (evt) => {\r\n        this.handleKeyDown(evt.key, evt.currentTarget, evt)\r\n      })\r\n    })\r\n  }\r\n\r\n  _getHeadButtons() {\r\n    return SelectorEngine.find(':scope > ' + SELECTOR_HEADBTN, this._element)\r\n  }\r\n\r\n  _focusNext(target) {\r\n    focusSimbling(target, this._getHeadButtons(), { loop: true })\r\n  }\r\n\r\n  _focusPrev(target) {\r\n    focusSimbling(target, this._getHeadButtons(), { isDirectionTop: true, loop: true })\r\n  }\r\n\r\n  _focusFirst(target) {\r\n    focusSimbling(target, this._getHeadButtons(), { isDirectionTop: true, isLimit: true })\r\n  }\r\n\r\n  _focusLast(target) {\r\n    focusSimbling(target, this._getHeadButtons(), { isLimit: true })\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Data Api implementation\r\n * ------------------------------------------------------------------------\r\n */\r\n/*const accordions = SelectorEngine.find(SELECTOR_HEADBTN_WRAPPER)\r\naccordions.forEach((acc) => {\r\n  Accordion.getOrCreateInstance(acc)\r\n})*/\r\n\r\n/*const accordionToggles = SelectorEngine.find(SELECTOR_HEADBTN)\r\naccordionToggles.forEach((toggle) => {\r\n  EventHandler.one(toggle, EVENT_KEYDOWN_DATA_API, (evt) => {\r\n    const parent = toggle.closest(SELECTOR_HEADBTN_WRAPPER)\r\n    if (parent) {\r\n      const accordion = Accordion.getOrCreateInstance(parent)\r\n      accordion.handleKeyDown(evt.key, toggle, evt)\r\n    }\r\n  })\r\n})*/\r\n\r\nEventHandler.on(document, EVENT_KEYDOWN_DATA_API, SELECTOR_HEADBTN, function (evt) {\r\n  const parent = this.closest(SELECTOR_HEADBTN_WRAPPER)\r\n  if (parent) {\r\n    const accordion = Accordion.getOrCreateInstance(parent)\r\n    accordion.handleKeyDown(evt.key, this, evt)\r\n  }\r\n})\r\n\r\nexport default Accordion\r\n"],"names":[],"mappings":"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"}