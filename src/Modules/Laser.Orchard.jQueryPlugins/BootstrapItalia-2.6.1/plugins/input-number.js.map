{"version":3,"file":"input-number.js","sources":["../../src/js/plugins/input-number.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component'\r\nimport EventHandler from 'bootstrap/js/src/dom/event-handler'\r\nimport SelectorEngine from 'bootstrap/js/src/dom/selector-engine'\r\n//import Manipulator from 'bootstrap/js/src/dom/manipulator'\r\n\r\nimport InputLabel from './input-label'\r\n\r\nconst NAME = 'inputnumber'\r\nconst DATA_KEY = 'bs.inputnumber'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\n\r\nconst EVENT_CLICK = `click${EVENT_KEY}`\r\nconst EVENT_CHANGE = `change${EVENT_KEY}`\r\n\r\n//const EVENT_FOCUS_DATA_API = `focus${EVENT_KEY}${DATA_API_KEY}`\r\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\r\nconst EVENT_MOUSEDOWN_DATA_API = `mousedown${EVENT_KEY}${DATA_API_KEY}`\r\nconst EVENT_KEYUP_DATA_API = `keyup${EVENT_KEY}${DATA_API_KEY}`\r\n\r\nconst CLASS_NAME_ADAPTIVE = 'input-number-adaptive'\r\nconst CLASS_NAME_PERCENTAGE = 'input-number-percentage'\r\nconst CLASS_NAME_CURRENCY = 'input-number-currency'\r\n//const CLASS_NAME_INCREMENT = 'input-number-add'\r\nconst CLASS_NAME_DECREMENT = 'input-number-sub'\r\n\r\nconst SELECTOR_WRAPPER = '.input-number'\r\nconst SELECTOR_INPUT = 'input[data-bs-input][type=\"number\"]'\r\nconst SELECTOR_BTN = 'button[class^=\"input-number-\"]'\r\n\r\nclass InputNumber extends BaseComponent {\r\n  constructor(element) {\r\n    super(element)\r\n\r\n    this._wrapperElement = this._element.closest(SELECTOR_WRAPPER)\r\n\r\n    this._label = new InputLabel(element)\r\n\r\n    this._init()\r\n    this._bindEvents()\r\n  }\r\n\r\n  // Getters\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n\r\n  // Private\r\n  _init() {\r\n    if (this._wrapperElement) {\r\n      this._inputResize()\r\n    }\r\n  }\r\n\r\n  _bindEvents() {\r\n    if (this._wrapperElement) {\r\n      SelectorEngine.find(SELECTOR_BTN, this._wrapperElement).forEach((btn) => {\r\n        EventHandler.on(btn, EVENT_CLICK, (evt) => {\r\n          evt.preventDefault()\r\n          this._incrDecr(btn.classList.contains(CLASS_NAME_DECREMENT))\r\n        })\r\n      })\r\n\r\n      EventHandler.on(this._element, EVENT_CHANGE, () => this._checkLimit())\r\n    }\r\n  }\r\n\r\n  _inputResize() {\r\n    if (this._wrapperElement.classList.contains(CLASS_NAME_ADAPTIVE)) {\r\n      let newWidth = null\r\n      //let newWidthIE = null\r\n      if (!this._wrapperElement.classList.contains(CLASS_NAME_PERCENTAGE)) {\r\n        newWidth = 'calc(44px + ' + this._element.value.length + 'ch)'\r\n        //newWidthIE = 'calc(44px + (1.5 * ' + this._element.value.length + 'ch))'\r\n      }\r\n      if (this._wrapperElement.classList.contains(CLASS_NAME_CURRENCY)) {\r\n        newWidth = 'calc(40px + 44px + ' + this._element.value.length + 'ch)'\r\n        //newWidthIE = 'calc(40px + 44px + (1.5 * ' + this._element.value.length + 'ch))'\r\n      }\r\n\r\n      if (newWidth) {\r\n        this._element.style.width = newWidth\r\n        //IE - this._element.style.width = calcIe\r\n      }\r\n    }\r\n  }\r\n\r\n  _incrDecr(isDecr) {\r\n    const inputVal = parseFloat(this._element.value)\r\n\r\n    if (!isNaN(inputVal)) {\r\n      //get step\r\n      let step = parseFloat(this._element.getAttribute('step'))\r\n      if (!step) {\r\n        step = 1\r\n      }\r\n\r\n      this._element.value = inputVal + step * (isDecr ? -1 : 1)\r\n      EventHandler.trigger(this._element, EVENT_CHANGE)\r\n    }\r\n  }\r\n\r\n  _checkLimit() {\r\n    const inputVal = parseFloat(this._element.value)\r\n\r\n    if (!isNaN(inputVal)) {\r\n      let val = inputVal\r\n      const max = parseFloat(this._element.getAttribute('max'))\r\n      const min = parseFloat(this._element.getAttribute('min'))\r\n\r\n      if (min && inputVal < min) {\r\n        val = min\r\n      }\r\n      //limit max\r\n      if (max && inputVal > max) {\r\n        val = max\r\n      }\r\n\r\n      this._element.value = val\r\n    }\r\n\r\n    this._inputResize()\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Data Api implementation\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\n/*const inputs = SelectorEngine.find(SELECTOR_INPUT)\r\ninputs.forEach((input) => {\r\n  EventHandler.one(input, EVENT_FOCUS_DATA_API, (evt) => {\r\n    evt.preventDefault()\r\n    InputNumber.getOrCreateInstance(input)\r\n    EventHandler.trigger(input, 'focus')\r\n  })\r\n})\r\n\r\nconst inputsButtons = SelectorEngine.find(SELECTOR_WRAPPER + ' ' + SELECTOR_BTN)\r\ninputsButtons.forEach((button) => {\r\n  EventHandler.one(button, EVENT_CLICK_DATA_API, (evt) => {\r\n    if (button.classList.contains(CLASS_NAME_INCREMENT) || button.classList.contains(CLASS_NAME_DECREMENT)) {\r\n      const wrapper = button.closest(SELECTOR_WRAPPER)\r\n      if (wrapper) {\r\n        const input = SelectorEngine.findOne(SELECTOR_INPUT, wrapper)\r\n        if (input) {\r\n          const inputNumber = InputNumber.getInstance(input)\r\n          if (!inputNumber) {\r\n            evt.preventDefault()\r\n            InputNumber.getOrCreateInstance(input)\r\n            EventHandler.trigger(button, 'click')\r\n          }\r\n        }\r\n      }\r\n    }\r\n  })\r\n})*/\r\n\r\nconst createInput = (element) => {\r\n  if (element && element.matches(SELECTOR_INPUT) && element.parentNode.querySelector(SELECTOR_BTN)) {\r\n    return InputNumber.getOrCreateInstance(element)\r\n  }\r\n  return null\r\n}\r\n\r\nEventHandler.on(document, EVENT_MOUSEDOWN_DATA_API, SELECTOR_INPUT + ', label', function () {\r\n  const target = InputLabel.getInputFromLabel(this) || this\r\n  createInput(target)\r\n})\r\nEventHandler.on(document, EVENT_KEYUP_DATA_API, SELECTOR_INPUT + ', label', function () {\r\n  const target = InputLabel.getInputFromLabel(this) || this\r\n  const element = createInput(target)\r\n  if (element && element._label) {\r\n    element._label._labelOut()\r\n  }\r\n})\r\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_BTN, function () {\r\n  const wrapper = this.closest(SELECTOR_WRAPPER)\r\n  if (wrapper) {\r\n    const input = SelectorEngine.findOne(SELECTOR_INPUT, wrapper)\r\n    if (input) {\r\n      InputNumber.getOrCreateInstance(input)\r\n    }\r\n  }\r\n})\r\n\r\nexport default InputNumber\r\n"],"names":[],"mappings":"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"}