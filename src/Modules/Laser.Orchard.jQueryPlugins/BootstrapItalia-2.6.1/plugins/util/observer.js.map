{"version":3,"file":"observer.js","sources":["../../../src/js/plugins/util/observer.js"],"sourcesContent":["/**\r\n * Mutation CSS Class Observer Object\r\n */\r\n//https://stackoverflow.com/a/53914092\r\n\r\nclass CssClassObserver {\r\n  constructor(targetNode, classToWatch, classAddedCallback, classRemovedCallback, ignoreToggle) {\r\n    this.targetNode = targetNode\r\n    this.classToWatch = classToWatch\r\n    this.classAddedCallback = classAddedCallback\r\n    this.classRemovedCallback = classRemovedCallback\r\n    this.observer = null\r\n    this.lastClassState = targetNode.classList.contains(this.classToWatch)\r\n    this.ignoreToggle = !!ignoreToggle\r\n\r\n    this.init()\r\n  }\r\n\r\n  init() {\r\n    this.observer = new MutationObserver((mutationsList) => this.mutationCallback(mutationsList))\r\n    this.observe()\r\n  }\r\n\r\n  observe() {\r\n    this.observer.observe(this.targetNode, { attributes: true })\r\n  }\r\n\r\n  disconnect() {\r\n    this.observer.disconnect()\r\n  }\r\n\r\n  mutationCallback(mutationsList) {\r\n    for (let mutation of mutationsList) {\r\n      if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\r\n        let currentClassState = mutation.target.classList.contains(this.classToWatch)\r\n        if (this.ignoreToggle || this.lastClassState !== currentClassState) {\r\n          this.lastClassState = currentClassState\r\n          if (currentClassState) {\r\n            if (typeof this.classAddedCallback === 'function') {\r\n              this.classAddedCallback()\r\n            }\r\n          } else if (typeof this.classRemovedCallback === 'function') {\r\n            this.classRemovedCallback()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Mutation Content Class Observer Object\r\n */\r\n\r\nclass ContentObserver {\r\n  constructor(targetNode, contentSelector, contentAddedCallback, contentRemovedCallback) {\r\n    this.targetNode = targetNode\r\n    this.contentSelector = contentSelector\r\n    this.contentAddedCallback = contentAddedCallback\r\n    this.contentRemovedCallback = contentRemovedCallback\r\n    this.observer = null\r\n\r\n    this.init()\r\n  }\r\n\r\n  //public\r\n\r\n  init() {\r\n    this.observer = new MutationObserver((mutationsList) => this.mutationCallback(mutationsList))\r\n    this.observe()\r\n  }\r\n\r\n  observe() {\r\n    this.observer.observe(this.targetNode, { childList: true, subtree: true })\r\n  }\r\n\r\n  disconnect() {\r\n    this.observer.disconnect()\r\n  }\r\n\r\n  mutationCallback(mutationsList) {\r\n    for (let mutation of mutationsList) {\r\n      if (mutation.type === 'childList') {\r\n        mutation.addedNodes.forEach((node) => {\r\n          this._callbackExec(node)\r\n        })\r\n        mutation.removedNodes.forEach((node) => {\r\n          this._callbackExec(node, true)\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  //private\r\n  _callbackExec(node, actionRemove) {\r\n    const foundNodes = node.matches && node.matches(this.contentSelector) ? [node] : node.querySelectorAll ? node.querySelectorAll(this.contentSelector) : null\r\n    const callback =\r\n      actionRemove && typeof this.contentRemovedCallback === 'function'\r\n        ? this.contentRemovedCallback\r\n        : typeof this.contentAddedCallback === 'function'\r\n        ? this.contentAddedCallback\r\n        : null\r\n    if (foundNodes && callback) {\r\n      foundNodes.forEach((node) => callback(node))\r\n    }\r\n  }\r\n}\r\n\r\nexport { CssClassObserver, ContentObserver }\r\n"],"names":[],"mappings":"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"}