{"version":3,"file":"cookiebar.js","sources":["../../src/js/plugins/cookiebar.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component.js'\r\n\r\nimport { /*defineJQueryPlugin,*/ isDisabled, getElementFromSelector, reflow } from 'bootstrap/js/src/util/index'\r\nimport EventHandler from 'bootstrap/js/src/dom/event-handler'\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Constants\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nconst NAME = 'cookiebar'\r\nconst VERSION = '5.0.0'\r\nconst DATA_KEY = 'bs.cookiebar'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\n//const JQUERY_NO_CONFLICT = $.fn[NAME]\r\nconst COOKIE_NAME = 'cookies_consent'\r\nconst COOKIE_VALUE = 'true'\r\nconst COOKIE_EXPIRE = 30\r\n\r\nconst SELECTOR_COOKIE_BAR = '.cookiebar'\r\nconst SELECTOR_ACCEPT = '[data-bs-accept=\"cookiebar\"]'\r\n\r\nconst EVENT_CLOSE = `close${EVENT_KEY}`\r\nconst EVENT_CLOSED = `closed${EVENT_KEY}`\r\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\r\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\r\n\r\nconst CLASS_NAME_COOKIE_BAR = 'cookiebar'\r\nconst CLASS_NAME_SHOW = 'show'\r\nconst CLASS_NAME_FADE = 'fade'\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Class Definition\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nclass Cookiebar extends BaseComponent {\r\n  constructor(element) {\r\n    super(element)\r\n\r\n    this._isShown = this._element.classList.contains(CLASS_NAME_SHOW)\r\n    this._isTransitioning = false\r\n  }\r\n\r\n  // Getters\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  static get VERSION() {\r\n    return VERSION\r\n  }\r\n\r\n  // Public\r\n\r\n  show() {\r\n    if (this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    this._isShown = true\r\n\r\n    if (this._isAnimated()) {\r\n      this._isTransitioning = true\r\n    }\r\n\r\n    this._showElement()\r\n  }\r\n\r\n  hide() {\r\n    if (!this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    this._isShown = false\r\n    const isAnimated = this._isAnimated()\r\n\r\n    if (isAnimated) {\r\n      this._isTransitioning = true\r\n    }\r\n\r\n    this._element.classList.remove(CLASS_NAME_SHOW)\r\n\r\n    this._queueCallback(() => this._hideElement(), this._element, isAnimated)\r\n  }\r\n\r\n  accept(element) {\r\n    element = element || this._element\r\n\r\n    const rootElement = this._getRootElement(element)\r\n    const customEvent = this._triggerCloseEvent(rootElement)\r\n\r\n    if (customEvent.defaultPrevented) {\r\n      return\r\n    }\r\n\r\n    this._setCookieEU()\r\n\r\n    this.hide()\r\n    //this._removeElement(rootElement)\r\n    //this.dispose()\r\n  }\r\n\r\n  /*dispose() {\r\n    $.removeData(this._element, DATA_KEY)\r\n    this._element = null\r\n  }*/\r\n\r\n  static clearCookie() {\r\n    document.cookie = COOKIE_NAME + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;'\r\n  }\r\n\r\n  // Private\r\n\r\n  _isAnimated() {\r\n    return this._element.classList.contains(CLASS_NAME_FADE)\r\n  }\r\n\r\n  _showElement() {\r\n    const isAnimated = this._isAnimated()\r\n\r\n    this._element.removeAttribute('aria-hidden')\r\n    this._element.setAttribute('aria-live', 'polite')\r\n\r\n    if (isAnimated) {\r\n      reflow(this._element)\r\n    }\r\n\r\n    this._element.classList.add(CLASS_NAME_SHOW)\r\n\r\n    const transitionComplete = () => {\r\n      this._isTransitioning = false\r\n    }\r\n\r\n    this._queueCallback(transitionComplete, this._element, isAnimated)\r\n  }\r\n\r\n  _hideElement() {\r\n    this._element.style.display = 'none'\r\n    this._element.setAttribute('aria-hidden', true)\r\n    this._element.removeAttribute('aria-live')\r\n    this._isTransitioning = false\r\n  }\r\n\r\n  _setCookieEU() {\r\n    var exdate = new Date()\r\n    exdate.setDate(exdate.getDate() + COOKIE_EXPIRE)\r\n    var c_value = escape(COOKIE_VALUE) + (COOKIE_EXPIRE == null ? '' : '; expires=' + exdate.toUTCString())\r\n    document.cookie = COOKIE_NAME + '=' + c_value + '; path=/; SameSite=Strict'\r\n  }\r\n\r\n  _getRootElement(element) {\r\n    const selector = getElementFromSelector(element)\r\n    let parent = null\r\n\r\n    if (selector) {\r\n      parent = selector\r\n    }\r\n\r\n    if (!parent) {\r\n      parent = element.closest(`.${CLASS_NAME_COOKIE_BAR}`) //$(element).closest(`.${CLASS_NAME_COOKIE_BAR}`)[0]\r\n    }\r\n\r\n    return parent\r\n  }\r\n\r\n  _triggerCloseEvent(element) {\r\n    /*const closeEvent = $.Event(EVENT_CLOSE)\r\n\r\n    $(element).trigger(closeEvent)*/\r\n\r\n    return EventHandler.trigger(element, EVENT_CLOSE)\r\n  }\r\n\r\n  _removeElement(element) {\r\n    //$(element).removeClass(CLASS_NAME_SHOW).attr('aria-hidden', 'true').attr('aria-live', 'off')\r\n    element.classList.remove(CLASS_NAME_SHOW)\r\n    element.setAttribute('aria-hidden', 'true')\r\n    element.setAttribute('aria-live', 'off')\r\n\r\n    //this._destroyElement(element)\r\n    EventHandler.trigger(element, EVENT_CLOSED)\r\n\r\n    this.dispose()\r\n  }\r\n\r\n  // Static\r\n\r\n  /*static _jQueryInterface(config) {\r\n    return this.each(function () {\r\n      const $element = $(this)\r\n      let data = $element.data(DATA_KEY)\r\n\r\n      if (!data) {\r\n        data = new Cookiebar(this)\r\n        $element.data(DATA_KEY, data)\r\n      }\r\n\r\n      if (typeof config === 'string') {\r\n        if (typeof data[config] === 'undefined') {\r\n          throw new TypeError(`No method named \"${config}\"`)\r\n        }\r\n        data[config](this)\r\n      }\r\n    })\r\n  }*/\r\n\r\n  static _handleAccept(cookiebarInstance) {\r\n    return function (event) {\r\n      if (event) {\r\n        event.preventDefault()\r\n      }\r\n\r\n      cookiebarInstance.close(this)\r\n    }\r\n  }\r\n\r\n  static _handleConsent(cookiebarInstance) {\r\n    return function (event) {\r\n      if (event) {\r\n        event.preventDefault()\r\n      }\r\n\r\n      cookiebarInstance.close(this)\r\n    }\r\n  }\r\n\r\n  static _getCookieEU() {\r\n    var i,\r\n      x,\r\n      y,\r\n      ARRcookies = document.cookie.split(';')\r\n    for (i = 0; i < ARRcookies.length; i++) {\r\n      x = ARRcookies[i].substring(0, ARRcookies[i].indexOf('='))\r\n      y = ARRcookies[i].substring(ARRcookies[i].indexOf('=') + 1)\r\n      x = x.replace(/^\\s+|\\s+$/g, '')\r\n      if (x == COOKIE_NAME) {\r\n        return unescape(y)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Data Api implementation\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\n//$(document).on(EVENT_CLICK_DATA_API, SELECTOR_ACCEPT, Cookiebar._handleAccept(new Cookiebar()))\r\n\r\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_ACCEPT, function (event) {\r\n  if (['A', 'AREA'].includes(this.tagName)) {\r\n    event.preventDefault()\r\n  }\r\n\r\n  if (isDisabled(this)) {\r\n    return\r\n  }\r\n\r\n  const target = getElementFromSelector(this) || this.closest(`.${NAME}`)\r\n  const instance = Cookiebar.getOrCreateInstance(target)\r\n  instance.accept()\r\n  //Cookiebar._handleAccept(new Cookiebar())\r\n})\r\n\r\nEventHandler.on(window, EVENT_LOAD_DATA_API, function () {\r\n  const consent = Cookiebar._getCookieEU()\r\n  if (!consent) {\r\n    const cookiebars = document.querySelectorAll(SELECTOR_COOKIE_BAR)\r\n    cookiebars.forEach((bar) => {\r\n      const instance = Cookiebar.getOrCreateInstance(bar)\r\n      instance.show()\r\n    })\r\n  }\r\n})\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * jQuery\r\n * ------------------------------------------------------------------------\r\n * add .Cookiebar to jQuery only if jQuery is present\r\n */\r\n\r\n//defineJQueryPlugin(Cookiebar)\r\n\r\nexport default Cookiebar\r\n"],"names":[],"mappings":";;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,IAAI,GAAG,YAAW;AACxB,MAAM,OAAO,GAAG,QAAO;AACvB,MAAM,QAAQ,GAAG,eAAc;AAC/B,MAAM,SAAS,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,EAAC;AAChC,MAAM,YAAY,GAAG,YAAW;AAChC;AACA,MAAM,WAAW,GAAG,kBAAiB;AACrC,MAAM,YAAY,GAAG,OAAM;AAC3B,MAAM,aAAa,GAAG,GAAE;AACxB;AACA,MAAM,mBAAmB,GAAG,aAAY;AACxC,MAAM,eAAe,GAAG,+BAA8B;AACtD;AACA,MAAM,WAAW,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC,EAAC;AACvC,MAAM,YAAY,GAAG,CAAC,MAAM,EAAE,SAAS,CAAC,EAAC;AACzC,MAAM,mBAAmB,GAAG,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE,YAAY,CAAC,EAAC;AAC7D,MAAM,oBAAoB,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC,EAAE,YAAY,CAAC,EAAC;AAC/D;AACA,MAAM,qBAAqB,GAAG,YAAW;AACzC,MAAM,eAAe,GAAG,OAAM;AAC9B,MAAM,eAAe,GAAG,OAAM;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,SAAS,SAAS,aAAa,CAAC;AACtC,EAAE,WAAW,CAAC,OAAO,EAAE;AACvB,IAAI,KAAK,CAAC,OAAO,EAAC;AAClB;AACA,IAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,eAAe,EAAC;AACrE,IAAI,IAAI,CAAC,gBAAgB,GAAG,MAAK;AACjC,GAAG;AACH;AACA;AACA,EAAE,WAAW,IAAI,GAAG;AACpB,IAAI,OAAO,IAAI;AACf,GAAG;AACH;AACA,EAAE,WAAW,OAAO,GAAG;AACvB,IAAI,OAAO,OAAO;AAClB,GAAG;AACH;AACA;AACA;AACA,EAAE,IAAI,GAAG;AACT,IAAI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAChD,MAAM,MAAM;AACZ,KAAK;AACL;AACA,IAAI,IAAI,CAAC,QAAQ,GAAG,KAAI;AACxB;AACA,IAAI,IAAI,IAAI,CAAC,WAAW,EAAE,EAAE;AAC5B,MAAM,IAAI,CAAC,gBAAgB,GAAG,KAAI;AAClC,KAAK;AACL;AACA,IAAI,IAAI,CAAC,YAAY,GAAE;AACvB,GAAG;AACH;AACA,EAAE,IAAI,GAAG;AACT,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,EAAE;AACjD,MAAM,MAAM;AACZ,KAAK;AACL;AACA,IAAI,IAAI,CAAC,QAAQ,GAAG,MAAK;AACzB,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,GAAE;AACzC;AACA,IAAI,IAAI,UAAU,EAAE;AACpB,MAAM,IAAI,CAAC,gBAAgB,GAAG,KAAI;AAClC,KAAK;AACL;AACA,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAC;AACnD;AACA,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,IAAI,CAAC,YAAY,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,UAAU,EAAC;AAC7E,GAAG;AACH;AACA,EAAE,MAAM,CAAC,OAAO,EAAE;AAClB,IAAI,OAAO,GAAG,OAAO,IAAI,IAAI,CAAC,SAAQ;AACtC;AACA,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,EAAC;AACrD,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAC;AAC5D;AACA,IAAI,IAAI,WAAW,CAAC,gBAAgB,EAAE;AACtC,MAAM,MAAM;AACZ,KAAK;AACL;AACA,IAAI,IAAI,CAAC,YAAY,GAAE;AACvB;AACA,IAAI,IAAI,CAAC,IAAI,GAAE;AACf;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,OAAO,WAAW,GAAG;AACvB,IAAI,QAAQ,CAAC,MAAM,GAAG,WAAW,GAAG,oDAAmD;AACvF,GAAG;AACH;AACA;AACA;AACA,EAAE,WAAW,GAAG;AAChB,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,eAAe,CAAC;AAC5D,GAAG;AACH;AACA,EAAE,YAAY,GAAG;AACjB,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,GAAE;AACzC;AACA,IAAI,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,aAAa,EAAC;AAChD,IAAI,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,WAAW,EAAE,QAAQ,EAAC;AACrD;AACA,IAAI,IAAI,UAAU,EAAE;AACpB,MAAM,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAC;AAC3B,KAAK;AACL;AACA,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,eAAe,EAAC;AAChD;AACA,IAAI,MAAM,kBAAkB,GAAG,MAAM;AACrC,MAAM,IAAI,CAAC,gBAAgB,GAAG,MAAK;AACnC,MAAK;AACL;AACA,IAAI,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,IAAI,CAAC,QAAQ,EAAE,UAAU,EAAC;AACtE,GAAG;AACH;AACA,EAAE,YAAY,GAAG;AACjB,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,OAAM;AACxC,IAAI,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,aAAa,EAAE,IAAI,EAAC;AACnD,IAAI,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,EAAC;AAC9C,IAAI,IAAI,CAAC,gBAAgB,GAAG,MAAK;AACjC,GAAG;AACH;AACA,EAAE,YAAY,GAAG;AACjB,IAAI,IAAI,MAAM,GAAG,IAAI,IAAI,GAAE;AAC3B,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE,GAAG,aAAa,EAAC;AACpD,IAAI,IAAI,OAAO,GAAG,MAAM,CAAC,YAAY,CAAC,IAAiC,YAAY,GAAG,MAAM,CAAC,WAAW,EAAE,EAAC;AAC3G,IAAI,QAAQ,CAAC,MAAM,GAAG,WAAW,GAAG,GAAG,GAAG,OAAO,GAAG,4BAA2B;AAC/E,GAAG;AACH;AACA,EAAE,eAAe,CAAC,OAAO,EAAE;AAC3B,IAAI,MAAM,QAAQ,GAAG,sBAAsB,CAAC,OAAO,EAAC;AACpD,IAAI,IAAI,MAAM,GAAG,KAAI;AACrB;AACA,IAAI,IAAI,QAAQ,EAAE;AAClB,MAAM,MAAM,GAAG,SAAQ;AACvB,KAAK;AACL;AACA,IAAI,IAAI,CAAC,MAAM,EAAE;AACjB,MAAM,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,qBAAqB,CAAC,CAAC,EAAC;AAC3D,KAAK;AACL;AACA,IAAI,OAAO,MAAM;AACjB,GAAG;AACH;AACA,EAAE,kBAAkB,CAAC,OAAO,EAAE;AAC9B;AACA;AACA;AACA;AACA,IAAI,OAAO,YAAY,CAAC,OAAO,CAAC,OAAO,EAAE,WAAW,CAAC;AACrD,GAAG;AACH;AACA,EAAE,cAAc,CAAC,OAAO,EAAE;AAC1B;AACA,IAAI,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAC;AAC7C,IAAI,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,EAAC;AAC/C,IAAI,OAAO,CAAC,YAAY,CAAC,WAAW,EAAE,KAAK,EAAC;AAC5C;AACA;AACA,IAAI,YAAY,CAAC,OAAO,CAAC,OAAO,EAAE,YAAY,EAAC;AAC/C;AACA,IAAI,IAAI,CAAC,OAAO,GAAE;AAClB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,OAAO,aAAa,CAAC,iBAAiB,EAAE;AAC1C,IAAI,OAAO,UAAU,KAAK,EAAE;AAC5B,MAAM,IAAI,KAAK,EAAE;AACjB,QAAQ,KAAK,CAAC,cAAc,GAAE;AAC9B,OAAO;AACP;AACA,MAAM,iBAAiB,CAAC,KAAK,CAAC,IAAI,EAAC;AACnC,KAAK;AACL,GAAG;AACH;AACA,EAAE,OAAO,cAAc,CAAC,iBAAiB,EAAE;AAC3C,IAAI,OAAO,UAAU,KAAK,EAAE;AAC5B,MAAM,IAAI,KAAK,EAAE;AACjB,QAAQ,KAAK,CAAC,cAAc,GAAE;AAC9B,OAAO;AACP;AACA,MAAM,iBAAiB,CAAC,KAAK,CAAC,IAAI,EAAC;AACnC,KAAK;AACL,GAAG;AACH;AACA,EAAE,OAAO,YAAY,GAAG;AACxB,IAAI,IAAI,CAAC;AACT,MAAM,CAAC;AACP,MAAM,CAAC;AACP,MAAM,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,EAAC;AAC7C,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC5C,MAAM,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;AAChE,MAAM,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAC;AACjE,MAAM,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,EAAC;AACrC,MAAM,IAAI,CAAC,IAAI,WAAW,EAAE;AAC5B,QAAQ,OAAO,QAAQ,CAAC,CAAC,CAAC;AAC1B,OAAO;AACP,KAAK;AACL,GAAG;AACH,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,CAAC,EAAE,CAAC,QAAQ,EAAE,oBAAoB,EAAE,eAAe,EAAE,UAAU,KAAK,EAAE;AAClF,EAAE,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;AAC5C,IAAI,KAAK,CAAC,cAAc,GAAE;AAC1B,GAAG;AACH;AACA,EAAE,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;AACxB,IAAI,MAAM;AACV,GAAG;AACH;AACA,EAAE,MAAM,MAAM,GAAG,sBAAsB,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAC;AACzE,EAAE,MAAM,QAAQ,GAAG,SAAS,CAAC,mBAAmB,CAAC,MAAM,EAAC;AACxD,EAAE,QAAQ,CAAC,MAAM,GAAE;AACnB;AACA,CAAC,EAAC;AACF;AACA,YAAY,CAAC,EAAE,CAAC,MAAM,EAAE,mBAAmB,EAAE,YAAY;AACzD,EAAE,MAAM,OAAO,GAAG,SAAS,CAAC,YAAY,GAAE;AAC1C,EAAE,IAAI,CAAC,OAAO,EAAE;AAChB,IAAI,MAAM,UAAU,GAAG,QAAQ,CAAC,gBAAgB,CAAC,mBAAmB,EAAC;AACrE,IAAI,UAAU,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK;AAChC,MAAM,MAAM,QAAQ,GAAG,SAAS,CAAC,mBAAmB,CAAC,GAAG,EAAC;AACzD,MAAM,QAAQ,CAAC,IAAI,GAAE;AACrB,KAAK,EAAC;AACN,GAAG;AACH,CAAC;;;;"}