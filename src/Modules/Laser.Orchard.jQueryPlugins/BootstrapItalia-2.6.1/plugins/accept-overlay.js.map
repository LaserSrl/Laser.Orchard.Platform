{"version":3,"file":"accept-overlay.js","sources":["../../src/js/plugins/accept-overlay.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component.js'\r\n\r\nimport { reflow } from 'bootstrap/js/src/util'\r\nimport { cookies } from './util/cookies'\r\nimport SelectorEngine from 'bootstrap/js/src/dom/selector-engine'\r\n\r\nconst NAME = 'acceptoverlay'\r\n\r\nconst CLASS_NAME_FADE = 'fade'\r\nconst CLASS_NAME_SHOW = 'show'\r\n\r\nconst SELECTOR_DATA_TOGGLE = '[data-bs-accept-from]'\r\nconst SELECTOR_DATA_REMEMBER = '[data-bs-accept-remember]'\r\n\r\nclass AcceptOverlay extends BaseComponent {\r\n  constructor(element, config) {\r\n    const parentElement = element.closest('.acceptoverlay')\r\n    super(parentElement)\r\n    const remember = cookies.isChoiceRemembered(config.service)\r\n    this._isShown = true\r\n    this._toggleElement = element\r\n    if (remember) {\r\n      this.hide()\r\n      setTimeout(() => {\r\n        this._toggleElement.dispatchEvent(new Event('click'))\r\n      }, 100)\r\n      return\r\n    }\r\n    this._toggleElement.addEventListener('click', () => {\r\n      this.hide()\r\n      this._remember = this._toggleElement.parentElement.querySelector(SELECTOR_DATA_REMEMBER).checked\r\n      cookies.rememberChoice(config.service, this._remember)\r\n    })\r\n  }\r\n\r\n  // Getters\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n\r\n  show() {\r\n    if (this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    this._isShown = true\r\n\r\n    if (this._isAnimated()) {\r\n      this._isTransitioning = true\r\n    }\r\n\r\n    this._showElement()\r\n  }\r\n\r\n  hide() {\r\n    if (!this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    this._isShown = false\r\n    const isAnimated = this._isAnimated()\r\n\r\n    if (isAnimated) {\r\n      this._isTransitioning = true\r\n    }\r\n\r\n    this._element.classList.remove(CLASS_NAME_SHOW)\r\n\r\n    this._queueCallback(() => this._hideElement(), this._element, isAnimated)\r\n  }\r\n\r\n  //Private\r\n\r\n  _isAnimated() {\r\n    return this._element.classList.contains(CLASS_NAME_FADE)\r\n  }\r\n\r\n  _showElement() {\r\n    const isAnimated = this._isAnimated()\r\n\r\n    this._element.removeAttribute('aria-hidden')\r\n\r\n    if (isAnimated) {\r\n      reflow(this._element)\r\n    }\r\n\r\n    this._element.classList.add(CLASS_NAME_SHOW)\r\n\r\n    const transitionComplete = () => {\r\n      this._isTransitioning = false\r\n    }\r\n\r\n    this._queueCallback(transitionComplete, this._element, isAnimated)\r\n  }\r\n\r\n  _hideElement() {\r\n    this._element.setAttribute('aria-hidden', true)\r\n    this._isTransitioning = false\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Data Api implementation\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nconst acceptOverlays = SelectorEngine.find(SELECTOR_DATA_TOGGLE)\r\nif (acceptOverlays.length > 0) {\r\n  acceptOverlays.forEach((element) => {\r\n    AcceptOverlay.getOrCreateInstance(element, { service: element.dataset.bsAcceptFrom })\r\n  })\r\n}\r\n\r\nexport default AcceptOverlay\r\n"],"names":[],"mappings":"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"}