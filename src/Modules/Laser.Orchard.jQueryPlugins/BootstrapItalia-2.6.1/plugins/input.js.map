{"version":3,"file":"input.js","sources":["../../src/js/plugins/input.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component.js'\r\n\r\nimport EventHandler from 'bootstrap/js/src/dom/event-handler'\r\nimport SelectorEngine from 'bootstrap/js/src/dom/selector-engine'\r\n\r\nimport InputLabel from './input-label'\r\n\r\nconst NAME = 'input'\r\nconst DATA_KEY = 'bs.input'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\n\r\nconst EVENT_MOUSEDOWN_DATA_API = `mousedown${EVENT_KEY}${DATA_API_KEY}`\r\nconst EVENT_KEYUP_DATA_API = `keyup${EVENT_KEY}${DATA_API_KEY}`\r\n\r\nconst EVENT_CHANGE = `change${EVENT_KEY}`\r\n\r\nclass Input extends BaseComponent {\r\n  constructor(element) {\r\n    super(element)\r\n\r\n    this._label = new InputLabel(element)\r\n    this._bindEvents()\r\n  }\r\n\r\n  // Getters\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n\r\n  // Private\r\n  _bindEvents() {\r\n    if (this._element.getAttribute('type') === 'file') {\r\n      EventHandler.on(this._element, EVENT_CHANGE, () => {\r\n        this._handleFileDescription()\r\n      })\r\n    }\r\n  }\r\n\r\n  _handleFileDescription() {\r\n    const fileNames = []\r\n    let labelPrefix = ''\r\n\r\n    Array.from(this._element.files).forEach((file) => {\r\n      const fileSize = Math.round(parseInt(file.size, 10) / 1024)\r\n      fileNames.push(file.name + ' (' + fileSize + 'kb)')\r\n    })\r\n\r\n    if (this._element.files.length > 1) {\r\n      labelPrefix = this._element.files.length + ' file da caricare: '\r\n    }\r\n\r\n    const label = SelectorEngine.findOne('label[for=\"' + this._element.getAttribute('id') + '\"] label.form-file-name', this._element)\r\n    if (label) {\r\n      label.innerText = labelPrefix + fileNames.join('; ')\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Data Api implementation\r\n * ------------------------------------------------------------------------\r\n */\r\nconst excludes = [\r\n  'select',\r\n  //'input[data-bs-input][type=\"number\"]',\r\n  'input[data-bs-input][type=\"password\"]',\r\n  'input.input-password[data-bs-input]',\r\n  'input[data-bs-autocomplete][type=\"search\"]',\r\n  'input[type=\"time\"]',\r\n]\r\n\r\n/*const inputs = SelectorEngine.find('input, textarea').filter((input) => {\r\n  let result = true\r\n  excludes.forEach((selector) => {\r\n    if (input.matches(selector)) {\r\n      result = false\r\n    }\r\n  })\r\n  return result\r\n})\r\ninputs.forEach((input) => {\r\n  Input.getOrCreateInstance(input)\r\n})*/\r\n\r\nconst createInput = (element) => {\r\n  const toExclude = !!excludes.find((selector) => element.matches(selector))\r\n  const isInputNumber = !!(element.getAttribute('type') === 'number' && element.parentNode.querySelector('button[class^=\"input-number-\"]')) //check if it's a InputNumber component\r\n  if (!toExclude && !isInputNumber) {\r\n    return Input.getOrCreateInstance(element)\r\n  }\r\n  return null\r\n}\r\n\r\nEventHandler.on(document, EVENT_MOUSEDOWN_DATA_API, 'input, textarea, label', function () {\r\n  const target = InputLabel.getInputFromLabel(this) || this\r\n  createInput(target)\r\n})\r\nEventHandler.on(document, EVENT_KEYUP_DATA_API, 'input, textarea, label', function () {\r\n  const target = InputLabel.getInputFromLabel(this) || this\r\n  const element = createInput(target)\r\n  if (element && element._label) {\r\n    element._label._labelOut()\r\n  }\r\n})\r\n\r\nexport default Input\r\n"],"names":[],"mappings":"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"}