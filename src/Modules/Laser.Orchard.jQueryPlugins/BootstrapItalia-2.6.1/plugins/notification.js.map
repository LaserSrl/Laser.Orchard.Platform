{"version":3,"file":"notification.js","sources":["../../src/js/plugins/notification.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component.js'\r\nimport { getElementFromSelector, isVisible, reflow } from 'bootstrap/js/src/util'\r\nimport Manipulator from 'bootstrap/js/src/dom/manipulator'\r\nimport EventHandler from 'bootstrap/js/src/dom/event-handler'\r\nimport { enableDismissTrigger } from 'bootstrap/js/src/util/component-functions'\r\n\r\nconst NAME = 'notification'\r\nconst DATA_KEY = 'bs.notification'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\n\r\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\r\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\r\nconst EVENT_SHOW = `show${EVENT_KEY}`\r\n\r\nconst Default = {\r\n  timeout: 0,\r\n}\r\n\r\nconst CLASS_NAME_FADE = 'fade'\r\nconst CLASS_NAME_SHOW = 'show'\r\n\r\nconst ATTRIBUTE_TIMEOUT = 'data-bs-timeout'\r\n\r\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"notification\"]'\r\n\r\n/**\r\n * toggle per attivazione\r\n * attrib per timeout (assegnabili al toggler o al componente, vince sempre il toggler)\r\n * gestione chiusura (dismissable)\r\n * la classe si riferisce all'elemento notification, con options, metodi open(timeout) e close (che deve gestire il timeout)\r\n **/\r\n\r\nclass Notification extends BaseComponent {\r\n  constructor(element, config) {\r\n    super(element)\r\n\r\n    this._config = this._getConfig(config)\r\n\r\n    this._isShown = this._element.classList.contains(CLASS_NAME_SHOW)\r\n    this._isTransitioning = false\r\n    this._toId = null\r\n  }\r\n\r\n  // Getters\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n\r\n  show(timeout, relatedTarget) {\r\n    if (this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    const timeoutVal = timeout || this._getElementTimeout(relatedTarget)\r\n\r\n    this._isShown = true\r\n\r\n    if (this._isAnimated()) {\r\n      this._isTransitioning = true\r\n    }\r\n\r\n    this._showElement(timeoutVal)\r\n  }\r\n\r\n  hide() {\r\n    if (!this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    this._isShown = false\r\n    const isAnimated = this._isAnimated()\r\n\r\n    if (isAnimated) {\r\n      this._isTransitioning = true\r\n    }\r\n\r\n    this._element.classList.remove(CLASS_NAME_SHOW)\r\n\r\n    this._queueCallback(() => this._hideElement(), this._element, isAnimated)\r\n  }\r\n\r\n  toggle(relatedTarget) {\r\n    this._isShown ? this.hide() : this.show(null, relatedTarget)\r\n  }\r\n\r\n  //Private\r\n\r\n  _isAnimated() {\r\n    return this._element.classList.contains(CLASS_NAME_FADE)\r\n  }\r\n\r\n  _showElement(timeout) {\r\n    const isAnimated = this._isAnimated()\r\n\r\n    this._element.style.display = 'block'\r\n    this._element.removeAttribute('aria-hidden')\r\n    //this._element.setAttribute('aria-modal', true)\r\n    //this._element.setAttribute('role', 'dialog')\r\n\r\n    if (isAnimated) {\r\n      reflow(this._element)\r\n    }\r\n\r\n    this._element.classList.add(CLASS_NAME_SHOW)\r\n\r\n    const transitionComplete = () => {\r\n      this._isTransitioning = false\r\n      if (timeout) {\r\n        this._setTimeout(timeout, () => this.hide())\r\n      }\r\n    }\r\n\r\n    this._queueCallback(transitionComplete, this._element, isAnimated)\r\n  }\r\n\r\n  _hideElement() {\r\n    this._element.style.display = 'none'\r\n    this._element.setAttribute('aria-hidden', true)\r\n    this._isTransitioning = false\r\n  }\r\n\r\n  _getConfig(config) {\r\n    config = {\r\n      ...Default,\r\n      ...Manipulator.getDataAttributes(this._element),\r\n      ...(typeof config === 'object' ? config : {}),\r\n    }\r\n    return config\r\n  }\r\n\r\n  _getElementTimeout(relatedTarget) {\r\n    const relTimeout = relatedTarget ? parseInt(relatedTarget.getAttribute(ATTRIBUTE_TIMEOUT)) : null\r\n    return relTimeout > 0 ? relTimeout : this._config.timeout\r\n  }\r\n\r\n  _setTimeout(duration, callback) {\r\n    this._clearTimeout()\r\n    setTimeout(callback, duration)\r\n  }\r\n  _clearTimeout() {\r\n    if (this._toId) {\r\n      clearTimeout(this._toId)\r\n      this._toId = null\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Data Api implementation\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\r\n  const target = getElementFromSelector(this)\r\n\r\n  if (['A', 'AREA'].includes(this.tagName)) {\r\n    event.preventDefault()\r\n  }\r\n\r\n  EventHandler.one(target, EVENT_SHOW, (showEvent) => {\r\n    if (showEvent.defaultPrevented) {\r\n      // only register focus restorer if modal will actually get shown\r\n      return\r\n    }\r\n\r\n    EventHandler.one(target, EVENT_HIDDEN, () => {\r\n      if (isVisible(this)) {\r\n        this.focus()\r\n      }\r\n    })\r\n  })\r\n\r\n  const data = Notification.getOrCreateInstance(target)\r\n\r\n  data.toggle(this)\r\n})\r\n\r\nenableDismissTrigger(Notification)\r\n\r\nexport default Notification\r\n"],"names":[],"mappings":"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"}